import 'dart:math';

/// 인사말 동적 생성 엔진
/// DB 대신 내장된 문구 구성 요소(도입 + 전개 + 결말)를 조합하여 수천 개의 자연스러운 문장을 생성합니다.
class GreetingGenerator {
  static final Random _random = Random();
  
  /// 감성 매핑: 한글 -> 영문
  static const Map<String, String> sentimentMapping = {
    '정중': 'polite',
    '위트': 'witty', 
    '따뜻': 'friendly',
    '시': 'poetic',
  };
  
  /// 영문 -> 한글 역매핑
  static const Map<String, String> sentimentReverseMapping = {
    'polite': '정중',
    'witty': '위트',
    'friendly': '따뜻',
    'poetic': '시',
  };

  /// 카테고리별, 톤별 문장 구성 요소 데이터
  static final Map<String, Map<String, _GreetingComponents>> _data = {
    // ==================== 새해 ====================
    '새해': {
      'polite': _GreetingComponents(
        openers: [
          "희망찬 새해를 맞이하여", "다사다난했던 한 해를 뒤로하고", "밝아오는 새해의 붉은 태양처럼",
          "새로운 희망으로 가득 찬 새해,", "2026년 새해 아침이 밝았습니다,", "소망하시는 일 모두 이루어지는 해,",
          "댁내 평안과 행복을 기원하며", "지난해 베풀어 주신 은혜에 감사드리며", "새해에는 더욱 건승하시기를 바라며"
        ],
        middles: [
          "귀하의 가정에 늘 사랑과 행복이 가득하기를", "하시는 모든 사업이 날로 번창하시기를", 
          "뜻하시는 모든 소망이 기적처럼 이루어지기를", "언제나 건강하시고 웃음꽃이 만발하시기를",
          "계획하시는 모든 일들이 순조롭게 풀리기를", "가족 모두가 화목하고 평안하시기를",
          "귀하의 앞날에 무궁한 영광과 발전이 함께하기를"
        ],
        enders: [
          "진심으로 기원합니다.", "간절히 소망합니다.", "마음 깊이 응원하겠습니다.", 
          "두 손 모아 기도합니다.", "머리 숙여 기원합니다.", "온 마음을 다해 바랍니다."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "새해 복은 택배로 보낼 수 없으니", "나이는 숫자에 불과하지만 떡국은 맛있으니까", 
          "올해 다이어트 계획은 작심삼일이 국룰이라지만", "로또 1등 당첨되는 꿈을 당신에게 양보하며",
          "새해에는 숨만 쉬어도 통장에 돈이 쌓이고", "적게 일하고 많이 버는 기적 같은 한 해가",
          "올해는 당신의 미모가 성수기를 맞아"
        ],
        middles: [
          "마음으로 가득 보낸 복, 반품 없이 다 받으시고", "한 살 더 먹는 건 억울해도 행복은 곱빼기로 챙기시고",
          "우리의 우정만큼은 작심백년으로 끈끈하게 이어가며", "당첨되면 나 모른 척하지 말고 콩고물이라도 나눠주시고",
          "걷기만 해도 살이 빠지는 마법 같은 일들이 일어나길", "월급은 오르고 스트레스는 내려가는 꿀 같은 날들 되길"
        ],
        enders: [
          "올해는 무조건 대박 나세요!", "배 터지게 복 많이 받으세요!", "맛있는 거 많이 먹고 건강하자!",
          "내년엔 더 멋진 우리가 되자!", "새해 복 많이 받고 부자 되세요!", "올해도 잘 부탁해 친구야!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "유난히 추운 겨울이지만 당신이 있어", "힘들었던 기억은 하얀 눈 속에 묻어두고", 
          "보이지 않는 곳에서도 늘 당신을 응원하는", "밥 잘 챙겨 먹고 아프지 말길 바라며",
          "새해라고 해서 거창한 다짐보다는", "당신은 세상에서 가장 소중한 사람이라는 걸",
          "차가운 바람 끝에 매달린 봄기운처럼"
        ],
        middles: [
          "내 마음은 언제나 따뜻한 봄날입니다", "새해에는 당신의 미소처럼 환한 일들만 가득하길",
          "제가 있다는 걸 잊지 말고 힘내셨으면 좋겠습니다", "당신의 2026년은 그 누구보다 빛날 거라고 믿어요",
          "그저 어제보다 오늘 더 많이 웃고 행복해지기를", "기억하며 올 한 해도 자신을 더 아껴주시기를",
          "당신의 얼어붙은 마음을 녹이는 따뜻한 온기가 되기를"
        ],
        enders: [
          "사랑합니다, 새해 복 많이 받으세요.", "늘 곁에서 응원할게요.", "당신의 행복을 기도합니다.",
          "올해도 우리 함께 걸어가요.", "당신은 충분히 잘하고 있어요.", "따뜻한 새해 맞이하세요."
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "차가운 대지 위로 피어오르는 아지랑이처럼", "새해라는 하얀 도화지 위에 당신의 꿈을", 
          "밤하늘의 별빛이 길을 잃은 나그네를 비추듯", "겨울이 지나면 반드시 따스한 봄이 오듯",
          "흐르는 강물처럼 멈추지 않는 열정으로", "새벽이슬 머금은 영롱한 풀잎처럼",
          "가장 깊은 어둠을 뚫고 솟아오르는 태양같이"
        ],
        middles: [
          "가슴 속에 잠든 희망의 씨앗이 찬란히 피어나기를", "물감 삼아 세상에서 가장 아름다운 그림을 그리시기를",
          "새해의 밝은 기운이 당신의 삶을 환하게 비추기를", "당신의 시련 뒤에는 눈부신 성취가 기다리고 있음을",
          "세상을 안으며 가장 아름다운 궤적을 남기는 해가 되기를", "당신의 영혼이 맑고 투명하게 빛나는 한 해가 되기를",
          "당신의 삶에 강인하고 뜨거운 생명력이 깃들기를"
        ],
        enders: [
          "간절한 마음으로 소망합니다.", "아름다운 계절을 맞이하소서.", "그 끝에는 감동이 있기를.",
          "당신을 위해 기도합니다.", "축복의 꽃비가 내리기를.", "온 마음 다해 축원합니다."
        ],
      ),
    },
    
    // ==================== 생일 ====================
    '생일': {
      'polite': _GreetingComponents(
        openers: [
          "귀하의 고귀한 탄신일을 진심으로 경하드리며", "뜻깊은 생신을 맞아 댁내에 평안이 깃들기를",
          "세상에 빛을 더해주신 귀하의 탄생에 감사하며", "생신을 진심으로 축하드립니다, 베풀어 주신 은혜에",
          "가족분들과 함께 따뜻하고 행복한 생신 보내시길", "일 년 중 가장 소중한 오늘, 귀하의 생신을"
        ],
        middles: [
          "오늘 하루 세상의 모든 축복과 사랑이 머물기를", "앞으로 펼쳐질 인생 여정에 행운이 함께하기를",
          "오늘이 귀하의 삶에서 가장 아름다운 페이지가 되기를", "늘 감사하며 앞날에 무궁한 영광이 가득하기를",
          "귀하의 인품처럼 향기롭고 넉넉한 마음으로", "축하하며 늘 강건하시고 행복하시기를"
        ],
        enders: [
          "간절히 기원합니다.", "진심으로 소망합니다.", "깊은 존경을 표합니다.",
          "마음 다해 축하드립니다.", "다시 한번 축하드립니다."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "지구 평화를 위해 태어난 당신,", "생일 축하해! 나이는 반품하고 싶겠지만", 
          "태어나줘서 고마워! 네가 없었다면", "생일 선물로 내 사랑을 듬뿍 담아 보냈는데",
          "촛불 끄느라 폐활량 테스트 좀 하겠지만", "오늘 생일이라며? 맛있는 거 사주면",
          "세상 혼자 사는 미모의 소유자,"
        ],
        middles: [
          "오늘만큼은 우주 정복 말고 케이크 정복을", "너의 미모와 지성은 반품 불가니 예쁘게 받자",
          "내 인생은 단무지 없는 김밥이었을 거야", "거부할 수 없는 매력적인 선물이라 반품은 안 돼",
          "오늘만큼은 네가 왕이니까 마음껏 즐기고", "내가 평생 축하해 줄 의향이 있는데 어때",
          "나이 먹는 건 서러워도 오늘을 즐겨봐"
        ],
        enders: [
          "격하게 축하한다!", "맛있게 먹고 행복하자!", "주인공은 너야 너!", "거절은 거절한다!",
          "내일부턴 다시 신하로!", "대박 나는 하루 보내!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "세상에 단 하나뿐인 소중한 너의 생일을", "오늘 하루는 걱정 근심 다 내려놓고", 
          "태어나줘서 고맙다는 말로는 부족할 만큼", "일 년에 단 한 번뿐인 오늘, 너의 미소가",
          "힘든 일도 많았겠지만 잘 버텨준 네가", "당신은 사랑받기 위해 태어난 사람이라는 걸",
          "네가 걷는 모든 발걸음마다"
        ],
        middles: [
          "진심으로 축하해, 넌 내게 정말 큰 선물이야", "네가 세상에서 가장 사랑받는 사람임을 느끼길",
          "넌 나에게 큰 위로이자 기쁨이야", "세상을 환하게 밝히는 등불이 되기를",
          "참 대견하고 자랑스러워, 너의 1년은 빛날 거야", "잊지 말고 오늘 가장 행복하게 웃기를",
          "따스한 햇살과 축복이 가득하기를"
        ],
        enders: [
          "사랑해, 생일 축하해.", "늘 곁에 있을게.", "너는 나의 보물이야.",
          "꽃길만 걷자.", "행복한 하루 보내.", "진심으로 축하해."
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "당신이 이 세상에 오던 날,", "계절이 수없이 바뀌어도 변하지 않는", 
          "당신이라는 아름다운 시 한 편이", "봄날의 햇살처럼 따스하고", 
          "장미의 열정과 백합의 순수를 품은", "별들이 속삭이며 내려온 오늘,"
        ],
        middles: [
          "하늘의 별 하나가 내려와 당신이라는 꽃이 되었습니다", "보석처럼 당신의 삶이 영롱하게 빛나기를",
          "세상에 낭송되기 시작한 첫 구절의 설렘처럼", "가을날의 바람처럼 시원한 행복이 머물기를",
          "오늘 피어난 웃음꽃이 지지 않는 향기가 되기를", "당신의 탄생은 이 우주가 준 선물입니다"
        ],
        enders: [
          "생일을 축복합니다.", "아름다운 날 되소서.", "영원히 빛나기를.", 
          "그 향기 가득하기를.", "축하의 마음을 전합니다."
        ],
      ),
    },
    
    // ==================== 감사 ====================
    '감사': {
      'polite': _GreetingComponents(
        openers: [
          "베풀어 주신 은혜와 배려에", "귀하의 헌신적인 도움 덕분에", 
          "바쁘신 와중에도 세심하게 마음 써주신 점", "보내주신 성원과 지지에",
          "따뜻한 격려와 조언이 제게는", "어려운 시기에 손을 내밀어 주셔서",
          "변함없는 신뢰를 보내주신 것에 대해"
        ],
        middles: [
          "깊이 감사드립니다, 그 마음 영원히 잊지 않겠습니다", "큰 어려움을 무사히 넘길 수 있었습니다",
          "진심으로 감사드립니다, 앞날에 행운이 가득하길", "머리 숙여 감사드립니다, 더욱 정진하여 보답하겠습니다",
          "큰 힘이 되었습니다, 소중한 인연을 귀하게 여기며", "다시 일어설 용기를 얻었습니다",
          "깊은 감사의 말씀을 올립니다"
        ],
        enders: [
          "존경과 감사를 표합니다.", "보답하며 살겠습니다.", "진심으로 기원합니다.",
          "늘 감사드립니다.", "잊지 않겠습니다."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "당신은 나의 구세주! 은혜 갚는 까치처럼", "도와주셔서 감사합니다, 제 마음속 지분을", 
          "당신의 도움 덕분에 제가 살았습니다,", "감사의 의미로 제 사랑을 가득 담은 하트를",
          "당신은 정말 천사인가요? 날개는 어디 숨기셨나요?", "이 은혜는 잊지 않고 3대가 떵떵거릴 때까지",
          "밥 한 끼로는 부족할 만큼 고맙지만"
        ],
        middles: [
          "나중에 꼭 로또 당첨되면 반띵...은 못 해도 밥은 쏠게요", "떼어드리고 싶지만 이미 당신이 대주주네요",
          "조만간 술 한 잔 거하게 쏘겠습니다", "뿅뿅 날립니다, 반사하기 없기!",
          "덕분에 위기를 탈출했습니다, 제가 날개가 되어드릴게요", "기억하겠습니다, 일단 커피부터 쏠게요",
          "일단 맛있는 거 먹으러 가요, 제가 삽니다"
        ],
        enders: [
          "충성!", "사랑합니다!", "진짜 고마워요!", "거절은 거절한다!", "당신이 최고!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "힘들 때마다 곁에서 묵묵히 지켜봐 준", "차가운 세상 속에서 당신의 배려는",
          "말하지 않아도 제 마음을 알아주는", "당신의 진심 어린 위로 한마디가",
          "함께여서 행복했고 당신 덕분에", "지친 제 어깨를 토닥여준 당신의 손길이",
          "당신이 베풀어준 그 따뜻한 마음이"
        ],
        middles: [
          "당신이 있어 얼마나 든든한지 모릅니다", "저에게 따뜻한 난로와 같았습니다",
          "당신이 있어서 참 다행입니다", "천만금보다 더 큰 힘이 되었습니다",
          "웃을 수 있었습니다, 소중한 시간 기억할게요", "얼마나 큰 위로가 되었는지 모릅니다",
          "제 가슴속에 깊이 남아있습니다"
        ],
        enders: [
          "평생 잊지 않을게요.", "정말 고마워요.", "사랑을 담아 전합니다.", 
          "늘 제 편이 되어주세요.", "진심으로 감사합니다."
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "메마른 대지에 내리는 단비처럼,", "어두운 밤바다를 비추는 등대처럼,",
          "스쳐 지나가는 바람인 줄 알았는데,", "당신이 건넨 따뜻한 손길은",
          "겨울나무가 봄을 기다리듯,", "그대의 배려는 삭막한 제 삶에",
          "밤하늘의 별빛처럼 조용히 다가와"
        ],
        middles: [
          "당신의 호의는 제 삶을 촉촉하게 적셔주었습니다", "당신은 제 인생의 길잡이가 되어주었습니다",
          "당신은 머물러 향기가 되는 꽃이었습니다", "제 가슴 속에 영원히 지지 않는 별이 되었습니다",
          "당신의 도움은 제게 희망의 새싹을 틔워주었습니다", "한 줄기 빛과 같은 위로가 되었습니다",
          "길을 밝혀준 그 마음을 잊지 않겠습니다"
        ],
        enders: [
          "꽃으로 피워내겠습니다.", "빛을 따라 나아가겠습니다.", "향기에 감사드립니다.",
          "별빛을 간직하겠습니다.", "그늘이 되어드리겠습니다.", "아름답게 기억하겠습니다."
        ],
      ),
    },
    
    // ==================== 크리스마스 ====================
    '크리스마스': {
      'polite': _GreetingComponents(
        openers: [
          "성탄의 기쁜 소식을 전하며", "거룩한 성탄절을 맞이하여", "따뜻한 연말, 즐거운 성탄을 맞아",
          "사랑과 평화의 크리스마스에", "희망찬 크리스마스를 보내시길", "축복받은 성탄절에"
        ],
        middles: [
          "가정에 행복과 평안이 가득하시기를", "주님의 은총이 머무르시기를",
          "사랑하는 가족과 함께 따뜻한 시간 되시기를", "건강하시고 소망하시는 일 모두 이루시기를",
          "기쁨과 감사가 넘치는 시간 되시기를"
        ],
        enders: [
          "진심으로 축원합니다.", "메리 크리스마스!", "행복한 성탄 보내세요.", "축복합니다."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "산타할아버지가 선물 대신 내 사랑을 두고 갔대요", "올해 산타에게 당신이 착했다고 로비했으니",
          "루돌프가 과로사하기 전에 미리 전하는", "산타 대신 내가 직접 배달하는 크리스마스 복",
          "칼로리 걱정 말고 케이크 폭식해도 되는 날"
        ],
        middles: [
          "선물은 내 마음만 받아주세요, 무료배송에 반품 불가!", "좋은 선물 많이 받고 나한테도 나눠주세요",
          "올해도 우리 함께 크리스마스 악동이 되어봐요", "눈이 안 와도 우리의 우정은 눈꽃처럼 순백이야"
        ],
        enders: [
          "메리 크리스마스! 케이크 먹자!", "해피 홀리데이!", "올해도 덕분에 행복했어!", "짠!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "따뜻한 크리스마스에 너를 생각해", "캐롤이 흘러나오는 거리에서 문득",
          "일 년 중 가장 설레는 오늘", "눈처럼 하얗고 순수한 마음을 담아",
          "올 한 해 함께해서 고마웠어"
        ],
        middles: [
          "네가 있어서 내 크리스마스는 완벽해", "행복한 연말 보내고 내년에도 함께하자",
          "따뜻한 차 한 잔의 여유가 있기를", "사랑하는 사람들과 행복한 시간 보내길 바라"
        ],
        enders: [
          "메리 크리스마스, 사랑해.", "따뜻한 연말 보내!", "내년에도 우리 함께!", "행복하자!"
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "하얀 눈이 내리는 고요한 밤,", "종소리가 울려 퍼지는 성스러운 이 날",
          "별빛처럼 반짝이는 그대에게", "겨울 하늘 아래 피어나는 사랑처럼"
        ],
        middles: [
          "따스한 촛불빛이 그대의 마음을 비추기를", "평화로운 선율이 영혼을 감싸기를",
          "사랑의 기적이 그대 곁에 머물기를"
        ],
        enders: [
          "축복의 종소리가 울려 퍼지기를.", "빛나는 성탄 되소서.", "은총이 함께하기를."
        ],
      ),
    },
    
    // ==================== 어버이날 ====================
    '어버이날': {
      'polite': _GreetingComponents(
        openers: [
          "부모님의 은혜에 깊이 감사드리며", "어버이의 사랑을 기리는 오늘", "낳아주시고 길러주신 은혜에",
          "부모님의 헌신적인 사랑에 감사하며", "어버이날을 맞아 존경과 사랑을 담아"
        ],
        middles: [
          "항상 건강하시고 행복하시기를", "편안하고 기쁜 날들만 가득하시기를",
          "부디 오래오래 건강하시기를", "자식들의 효도를 받으시며 행복하시기를"
        ],
        enders: [
          "감사합니다, 사랑합니다.", "진심으로 존경합니다.", "효도하며 살겠습니다.", "감사드립니다."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "엄마 아빠! 오늘은 제가 카네이션이에요", "잔소리도 사랑이라는 걸 이제야 알았어요",
          "용돈 드리고 싶은데 통장이 바닥이라", "효도 포인트 적립 중이니 조금만 기다려 주세요"
        ],
        middles: [
          "그래도 마음만은 백만 원짜리입니다", "사랑하는 마음만은 세계 최고라고요",
          "부모님이 세상에서 제일 좋아요"
        ],
        enders: [
          "사랑해요!", "효도할게요!", "건강하세요!", "최고!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "엄마, 아빠, 늘 고마워요", "말로는 다 표현 못 하지만", "세상에서 가장 좋은 우리 부모님"
        ],
        middles: [
          "그동안 표현 못 해서 미안해요, 많이 사랑해요", "아프지 말고 오래오래 건강하세요",
          "언제나 제 편이 되어주셔서 고마워요"
        ],
        enders: [
          "사랑합니다.", "효도할게요.", "건강하세요."
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "나를 세상에 있게 해 준 두 분의 사랑,", "거친 풍파 속에서도 지켜준 등대 같은 사랑",
          "봄날의 햇살처럼 따뜻한 품"
        ],
        middles: [
          "그 사랑의 크기는 하늘보다 높고 바다보다 깊습니다", "갚을 길 없는 은혜에 그저 고개 숙입니다"
        ],
        enders: [
          "영원히 감사드립니다.", "존경합니다.", "사랑합니다."
        ],
      ),
    },
    
    // ==================== 스승의날 ====================
    '스승의날': {
      'polite': _GreetingComponents(
        openers: [
          "스승의 은혜에 깊이 감사드리며", "가르침의 은혜를 기리는 오늘", "선생님의 헌신에 감사드리며"
        ],
        middles: [
          "선생님의 가르침 덕분에 오늘의 제가 있습니다", "배움의 은혜를 평생 잊지 않겠습니다",
          "선생님처럼 훌륭한 사람이 되도록 노력하겠습니다"
        ],
        enders: [
          "존경합니다.", "감사합니다.", "항상 건강하세요."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "선생님! 숙제 자주 안 해도 잘 봐주셔서", "수업 시간에 졸았던 거 다 기억하시죠?",
          "그때 왜 그랬는지 이제야 알겠어요"
        ],
        middles: [
          "그래도 끝까지 포기하지 않고 가르쳐주셔서 감사해요", "덕분에 그래도 이만큼 컸어요",
          "성인이 된 지금 선생님의 고충을 알겠습니다"
        ],
        enders: [
          "감사합니다!", "사랑합니다!", "건강하세요!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "선생님, 그때 저 기억하시나요?", "오래전 가르침이 아직도 기억에 남아요"
        ],
        middles: [
          "선생님 덕분에 지금의 제가 있어요", "힘들 때마다 선생님 말씀을 떠올려요"
        ],
        enders: [
          "늘 감사해요.", "건강하세요.", "보고 싶어요."
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "어둠 속에서 길을 밝혀주신 등불처럼", "마른 땅에 내린 단비 같은 가르침"
        ],
        middles: [
          "선생님의 지혜는 영원히 빛날 것입니다", "그 가르침을 가슴에 새기며 살겠습니다"
        ],
        enders: [
          "깊이 존경합니다.", "감사드립니다."
        ],
      ),
    },
    
    // ==================== 결혼 ====================
    '결혼': {
      'polite': _GreetingComponents(
        openers: [
          "두 분의 아름다운 결합을 진심으로 축하드립니다", "백년해로의 인연을 맺으신 것을 경하드리며",
          "사랑으로 맺어진 두 분의 새 출발을"
        ],
        middles: [
          "앞으로의 인생길에 행복만 가득하기를", "서로를 아끼고 사랑하며 화목한 가정 이루시기를",
          "평생 서로의 빛이 되어주시기를"
        ],
        enders: [
          "진심으로 축하드립니다.", "두 분의 행복을 기원합니다.", "축복합니다."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "드디어 결혼! 이제 자유는 끝이야!", "축의금 때문에 통장이 울고 있지만",
          "솔로 탈출 축하해! 로또보다 어려운 걸 해냈네"
        ],
        middles: [
          "행복하게 잘 살고 우리 모임엔 빠지지 마", "싸워도 화해하고 맛있는 거 많이 해 먹어",
          "애들 낳으면 삼촌 숙모 잊지 마라"
        ],
        enders: [
          "결혼 축하해!", "행복하게 살아!", "대박!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "사랑하는 두 사람의 결혼을 축하해", "오래 기다린 결실, 정말 축하해",
          "드디어 이 날이 왔네"
        ],
        middles: [
          "앞으로의 날들이 모두 행복하길 바라", "서로 아껴주고 사랑하며 행복하게 살아",
          "힘들 때 서로 의지하며 함께해"
        ],
        enders: [
          "축하해!", "행복해!", "사랑해!"
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "두 줄기 강물이 만나 바다를 이루듯", "별빛 아래 맺은 영원한 약속",
          "사랑이라는 이름의 꽃이 피어나"
        ],
        middles: [
          "두 분의 사랑이 영원토록 빛나기를", "서로의 길을 비추는 등불이 되기를"
        ],
        enders: [
          "축복합니다.", "영원하기를.", "아름답기를."
        ],
      ),
    },
    
    // ==================== 졸업 ====================
    '졸업': {
      'polite': _GreetingComponents(
        openers: [
          "졸업을 진심으로 축하드립니다", "그동안의 노력에 박수를 보내며", "새로운 출발을 앞둔 당신에게"
        ],
        middles: [
          "앞으로의 인생에 무한한 가능성이 펼쳐지기를", "배움의 열정을 잃지 않고 더 큰 꿈을 향해",
          "지금까지의 노력이 빛나는 미래로 이어지기를"
        ],
        enders: [
          "축하합니다.", "응원합니다.", "힘내세요."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "졸업 축하해! 이제 진짜 어른이야", "학교 급식이 그리워질 거야",
          "사회라는 정글에 오신 걸 환영해"
        ],
        middles: [
          "걱정 마, 우리 모두 이겨냈으니까 너도 할 수 있어", "취업 걱정은 잠시 접어두고 오늘만 즐겨"
        ],
        enders: [
          "졸업 축하!", "파이팅!", "대박 나라!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "졸업 축하해!", "고생 많았어, 정말 대단해", "드디어 해냈네"
        ],
        middles: [
          "앞으로의 날들이 더 빛나길 바라", "네가 하고 싶은 일 다 이루길 응원해"
        ],
        enders: [
          "축하해!", "화이팅!", "응원해!"
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "배움의 여정을 마치고 새로운 하늘을 향해", "한 장의 문이 닫히고 새로운 세계가 열리는 순간"
        ],
        middles: [
          "당신의 날개가 드넓은 창공을 누비기를", "미래의 빛이 그대를 비추기를"
        ],
        enders: [
          "축하합니다.", "빛나기를."
        ],
      ),
    },
    
    // ==================== 입학 ====================
    '입학': {
      'polite': _GreetingComponents(
        openers: [
          "입학을 진심으로 축하드립니다", "새로운 배움의 여정을 시작하는 당신에게"
        ],
        middles: [
          "원하시는 바 모두 이루시기를", "즐겁고 보람찬 학교생활이 되기를"
        ],
        enders: [
          "축하합니다.", "응원합니다."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "입학 축하해! 이제 시작이야", "학교생활 스타트! 급식 잘 먹어"
        ],
        middles: [
          "친구 많이 사귀고 재밌게 다녀", "공부도 중요하지만 추억도 많이 만들어"
        ],
        enders: [
          "화이팅!", "즐겨!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "입학 축하해!", "새로운 시작, 설레겠다"
        ],
        middles: [
          "좋은 친구 많이 만나고 즐거운 학교생활 해", "뭐든 도전해봐"
        ],
        enders: [
          "응원해!", "화이팅!"
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "새로운 배움의 바다로 항해를 시작하는 날"
        ],
        middles: [
          "지식의 보물섬을 향해 힘차게 나아가기를"
        ],
        enders: [
          "축복합니다."
        ],
      ),
    },
    
    // ==================== 출산 ====================
    '출산': {
      'polite': _GreetingComponents(
        openers: [
          "건강한 아기의 탄생을 축하드립니다", "귀한 생명의 탄생을 진심으로 경하드립니다"
        ],
        middles: [
          "산모분과 아기 모두 건강하시기를", "기쁨과 축복이 가득한 가정이 되시기를"
        ],
        enders: [
          "축하드립니다.", "행복하세요."
        ],
      ),
      'witty': _GreetingComponents(
        openers: [
          "출산 축하해! 이제 잠은 못 자겠지만", "아기 탄생 축하! 미리 말해둘게, 힘들어도 버텨"
        ],
        middles: [
          "그래도 천사 같은 아기 보면 다 잊어버려", "육아 스펙 쌓으러 가는 거야"
        ],
        enders: [
          "축하해!", "화이팅!"
        ],
      ),
      'friendly': _GreetingComponents(
        openers: [
          "아기 탄생 축하해!", "드디어 엄마(아빠)가 됐네"
        ],
        middles: [
          "아기도 엄마도 건강하길 바라", "예쁘게 잘 키워"
        ],
        enders: [
          "축하해!", "행복해!"
        ],
      ),
      'poetic': _GreetingComponents(
        openers: [
          "세상에서 가장 아름다운 선물이 도착했습니다"
        ],
        middles: [
          "작은 손과 발이 세상을 향해 첫 발을 내딛었습니다"
        ],
        enders: [
          "축복합니다."
        ],
      ),
    },
  };

  /// 지원하는 모든 카테고리 목록
  static List<String> get topics => _data.keys.toList();
  
  /// 지원하는 모든 감성 목록 (영문)
  static List<String> get sentiments => ['polite', 'witty', 'friendly', 'poetic'];

  /// 랜덤 인사말 생성
  /// [topic] 카테고리 (새해, 생일, 감사 등)
  /// [sentiment] 감성 (polite, witty, friendly, poetic)
  static String? generateGreeting(String topic, String sentiment) {
    final topicData = _data[topic];
    if (topicData == null) return _generateFallback(topic, sentiment);
    
    final components = topicData[sentiment];
    if (components == null) return _generateFallback(topic, sentiment);
    
    return _buildSentence(components);
  }
  
  /// 여러 개의 인사말 생성
  static List<String> generateMultipleGreetings(String topic, String sentiment, int count) {
    final Set<String> results = {};
    int attempts = 0;
    
    while (results.length < count && attempts < count * 10) {
      final greeting = generateGreeting(topic, sentiment);
      if (greeting != null && greeting.length >= 30) {
        results.add(greeting);
      }
      attempts++;
    }
    
    return results.toList();
  }
  
  /// 문장 조합
  static String _buildSentence(_GreetingComponents components) {
    final opener = components.openers[_random.nextInt(components.openers.length)];
    final middle = components.middles[_random.nextInt(components.middles.length)];
    final ender = components.enders[_random.nextInt(components.enders.length)];
    
    // 도입부 끝에 쉼표가 없으면 추가
    String formattedOpener = opener;
    if (!opener.endsWith(',') && !opener.endsWith('!') && !opener.endsWith('.')) {
      formattedOpener = '$opener,';
    }
    
    return '$formattedOpener $middle $ender';
  }
  
  /// 데이터가 없는 카테고리를 위한 기본 문구 생성
  static String? _generateFallback(String topic, String sentiment) {
    final fallbackOpeners = [
      "$topic을(를) 맞이하여", "뜻깊은 $topic에", "소중한 $topic을(를) 축하하며",
      "$topic을(를) 진심으로 축하드리며"
    ];
    
    final fallbackMiddles = [
      "늘 행복하시길 바랍니다", "좋은 일만 가득하길 기원합니다", 
      "앞날에 축복이 있기를", "건강하시고 평안하시기를"
    ];
    
    List<String> fallbackEnders;
    switch (sentiment) {
      case 'witty':
        fallbackEnders = ["대박 나세요!", "아자아자 파이팅!", "최고!"];
        break;
      case 'poetic':
        fallbackEnders = ["간절히 소망합니다.", "온 마음 다해 축원합니다."];
        break;
      case 'friendly':
        fallbackEnders = ["사랑해요!", "응원할게요!", "행복하세요!"];
        break;
      default:
        fallbackEnders = ["삼가 축하의 말씀을 올립니다.", "건승을 기원합니다.", "진심으로 축하드립니다."];
    }
    
    final opener = fallbackOpeners[_random.nextInt(fallbackOpeners.length)];
    final middle = fallbackMiddles[_random.nextInt(fallbackMiddles.length)];
    final ender = fallbackEnders[_random.nextInt(fallbackEnders.length)];
    
    return '$opener, $middle $ender';
  }
}

/// 문장 구성 요소 클래스
class _GreetingComponents {
  final List<String> openers;
  final List<String> middles;
  final List<String> enders;
  
  const _GreetingComponents({
    required this.openers,
    required this.middles,
    required this.enders,
  });
}
